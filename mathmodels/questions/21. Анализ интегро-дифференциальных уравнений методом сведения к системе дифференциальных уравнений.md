##### 21. Анализ интегро-дифференциальных уравнений методом сведения к системе обыкновенных дифференциальных уравнений. Недостатки этого подхода.
Продифференцируем финальную версию закона токов Кирхгофа, вводя ещё одну переменную $\mathbf{\Theta}=\frac{d\phi}{dt}$
$$\begin{align}
\mathbf{A}_C\mathbf{C}\mathbf{A}_C^T\times
\frac{d\mathbf{\Theta}}{dt}&=-\mathbf{A}_R
\mathbf{R}^{-1}\mathbf{A}_R^T\times\mathbf{\Theta}-
\mathbf{A}_L\mathbf{L}^{-1}\mathbf{A}_L^T\phi-
\mathbf{A}_Nf'(\phi)\times\mathbf{\Theta}\\
\frac{d\phi}{dt}&=\mathbf{\Theta}
\end{align}
$$
Применить RKF45 мешают два момента:
- Система не разрешена относительно производной, а с обращением матрицы есть проблемы, так как она особенная. Несколько уравнений превращаются в алгебраические, но автоматизировать этот процесс сложно.
- Требуется задать начальные условия $\phi(0)$ и $\mathbf{\Theta}(0)$, что является непреодолимым препятствием для больших схем

Таким образом:
- Модель должна быть разрешена относительно производных
- В роли фазовых переменных следует использовать $\mathbf{U}_C$ и $\mathbf{I}_L$, для которых есть начальные условия